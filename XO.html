<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tr√≤ ch∆°i XO Tri·∫øt</title>
<style>
body{font-family:Inter,Arial,sans-serif;background:#0f172a;color:#e5e7eb;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
.wrap{width:95%;max-width:900px;background:#111827;border-radius:12px;padding:20px;box-shadow:0 0 25px rgba(0,0,0,0.4)}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.board{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin:16px 0}
.cell{background:#1e293b;color:#f1f5f9;font-size:42px;display:flex;align-items:center;justify-content:center;height:100px;border-radius:8px;cursor:pointer;transition:0.2s}
.cell.disabled{opacity:.6;cursor:not-allowed}
.status{margin:6px 0;color:#cbd5e1;min-height:22px}
.questions-grid{display:grid;grid-template-columns:repeat(9,1fr);gap:6px;margin:10px 0}
.qnum{background:#1d4ed8;color:white;border:none;padding:6px 0;border-radius:6px;cursor:pointer;font-weight:600;transition:.2s}
.qnum:hover{background:#2563eb}
.qnum.answered{background:#334155;color:#64748b;cursor:not-allowed;opacity:0.6}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;visibility:hidden;opacity:0;transition:.2s}
.modal.show{visibility:visible;opacity:1}
.qcard{background:#0b1120;padding:18px;border-radius:10px;width:min(700px,90%)}
.qtext{margin-bottom:12px;font-weight:600}
.options{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.opt{padding:10px;background:#1e293b;color:white;border:none;border-radius:6px;cursor:pointer;text-align:left;font-size:14px;transition:.2s}
.opt:hover{background:#334155}
.opt.correct{background:#16a34a;color:white}
.opt.wrong{background:#dc2626;color:white}
footer{margin-top:10px;color:#94a3b8;font-size:13px;text-align:right}
.btn{padding:6px 10px;border:none;border-radius:6px;cursor:pointer;margin-left:5px}
.btn.primary{background:#38bdf8;color:#0f172a;font-weight:600}
.team{cursor:pointer;padding:6px 12px;border-radius:6px;background:#1e293b;margin-right:8px;display:inline-block;transition:.2s}
.team.active{background:#38bdf8;color:#0f172a;font-weight:700}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <span id="teamX" class="team">ƒê·ªôi X</span>
      <span id="teamO" class="team">ƒê·ªôi O</span>
    </div>
    <div>
      <button id="next" class="btn">Next Match</button>
      <button id="reset" class="btn primary">Reset</button>
    </div>
  </header>

  <div class="status" id="status">Ch·ªçn ƒë·ªôi ƒë·ªÉ b·∫Øt ƒë·∫ßu.</div>
  <div class="board" id="board"></div>

  <div>
    <div class="status">Ch·ªçn c√¢u h·ªèi (T·ªïng 27 c√¢u):</div>
    <div class="questions-grid" id="qGrid"></div>
  </div>

  <footer>‚úÖ ƒê√∫ng: ƒë·ªôi hi·ªán t·∫°i ƒë√°nh | ‚ùå Sai: ƒë·ªôi ƒë·ªëi th·ªß ch·ªçn √¥ ƒë·ªÉ ƒë√°nh h·ªô ƒë·ªôi sai.</footer>
</div>

<!-- Modal hi·ªÉn th·ªã c√¢u h·ªèi -->
<div class="modal" id="modal">
  <div class="qcard">
    <div class="qtext" id="qText"></div>
    <div class="options" id="qOpts"></div>
    <div class="status" id="feedback"></div>
    <div style="text-align:right;margin-top:10px">
      <button class="btn" id="closeModal">ƒê√≥ng</button>
    </div>
  </div>
</div>

<script>
/* --- To√†n b·ªô 27 c√¢u h·ªèi --- */
const questions=[
{id:1,q:"Theo V.I. L√™nin, giai c·∫•p l√† g√¨?",opts:["A. Nh√≥m ng∆∞·ªùi c√≥ c√πng s·ªü th√≠ch","B. Nh√≥m ng∆∞·ªùi kh√°c nhau v·ªÅ ƒë·ªãa v·ªã trong s·∫£n xu·∫•t","C. Nh√≥m ngh·ªÅ nghi·ªáp","D. T·∫ßng l·ªõp gi√†u c√≥"],ans:1},
{id:2,q:"Ngu·ªìn g·ªëc h√¨nh th√†nh giai c·∫•p?",opts:["A. Ph√¢n bi·ªát ch·ªßng t·ªôc","B. T∆∞ h·ªØu v√† ph√¢n c√¥ng lao ƒë·ªông x√£ h·ªôi","C. Gi·ªõi t√≠nh","D. Ph√°t tri·ªÉn c√¥ng ngh·ªá"],ans:1},
{id:3,q:"Quan h·ªá gi·ªØa c√°c giai c·∫•p c∆° b·∫£n l√†?",opts:["A. H·ª£p t√°c b√¨nh ƒë·∫≥ng","B. ƒê·ªëi l·∫≠p l·ª£i √≠ch KT-CT","C. C·∫°nh tranh t·ª± do","D. Kh√¥ng m√¢u thu·∫´n"],ans:1},
{id:4,q:"K·∫øt c·∫•u XH - giai c·∫•p g·ªìm?",opts:["A. D√¢n t·ªôc, gi·ªõi t√≠nh, t√¥n gi√°o","B. Giai c·∫•p, t·∫ßng l·ªõp x√£ h·ªôi","C. ƒê·ªãa l√Ω, vƒÉn h√≥a","D. Ch√≠nh tr·ªã, ph√°p lu·∫≠t"],ans:1},
{id:5,q:"Giai c·∫•p th·ªëng tr·ªã l√†?",opts:["A. ƒê√¥ng nh·∫•t","B. N·∫Øm quy·ªÅn KT-CT-TT","C. H·ªçc v·∫•n cao","D. Thu nh·∫≠p TB"],ans:1},
{id:6,q:"Trong CNTB, hai giai c·∫•p c∆° b·∫£n l√†?",opts:["A. ƒê·ªãa ch·ªß-n√¥ng d√¢n","B. Qu√Ω t·ªôc-n√¥ng n√¥","C. T∆∞ s·∫£n-v√¥ s·∫£n","D. N√¥ng d√¢n-ti·ªÉu th∆∞∆°ng"],ans:2},
{id:7,q:"Di chuy·ªÉn gi·ªØa c√°c giai c·∫•p g·ªçi l√†?",opts:["A. Bi·∫øn ƒë·ªông","B. Ph√¢n t·∫ßng","C. Di ƒë·ªông x√£ h·ªôi","D. T√°i c·∫•u tr√∫c"],ans:2},
{id:8,q:"ƒê·∫•u tranh giai c·∫•p l√†?",opts:["A. C·∫°nh tranh c√° nh√¢n","B. ƒê·∫•u tranh gi·ªØa giai c·∫•p ƒë·ªëi l·∫≠p l·ª£i √≠ch KT-CT-XH","C. Chi·∫øn tranh qu·ªëc gia","D. Xung ƒë·ªôt vƒÉn h√≥a"],ans:1},
{id:9,q:"Ngu·ªìn g·ªëc t·∫•t y·∫øu c·ªßa ƒë·∫•u tranh giai c·∫•p?",opts:["A. M√¢u thu·∫´n quy·ªÅn l·ª±c","B. M√¢u thu·∫´n l·ª£i √≠ch kinh t·∫ø","C. M√¢u thu·∫´n t√¥n gi√°o","D. Khoa h·ªçc k·ªπ thu·∫≠t"],ans:1},
{id:10,q:"Th·ª±c ch·∫•t ƒë·∫•u tranh giai c·∫•p l√†?",opts:["A. VƒÉn h√≥a","B. Quy·ªÅn l·ª±c KT-CT","C. C√° nh√¢n","D. Chi·∫øn tranh"],ans:1},
{id:11,q:"Vai tr√≤ c·ªßa ƒë·∫•u tranh giai c·∫•p?",opts:["A. R·ªëi lo·∫°n","B. ƒê·ªông l·ª±c l·ªãch s·ª≠","C. Suy t√†n","D. Kh√¥ng vai tr√≤"],ans:1},
{id:12,q:"M·ª•c ti√™u cu·ªëi c√πng c·ªßa v√¥ s·∫£n?",opts:["A. Chi·∫øm ƒëo·∫°t t√†i s·∫£n","B. X√≥a b·ªè giai c·∫•p","C. Gi√†nh quy·ªÅn t·∫°m th·ªùi","D. TƒÉng thu nh·∫≠p"],ans:1},
{id:13,q:"ƒê·∫•u tranh giai c·∫•p trong CNXH?",opts:["A. Kh√¥ng c√≤n","B. T·ªìn t·∫°i v·ªõi n·ªôi dung m·ªõi","C. Gay g·∫Øt h∆°n","D. Ch·ªâ trong kinh t·∫ø"],ans:1},
{id:14,q:"H√¨nh th·ª©c c∆° b·∫£n c·ªßa ƒë·∫•u tranh giai c·∫•p?",opts:["A. Qu√¢n s·ª±","B. Ch√≠nh tr·ªã, t∆∞ t∆∞·ªüng, kinh t·∫ø","C. C√° nh√¢n","D. T√¥n gi√°o"],ans:1},
{id:15,q:"Cu·ªôc ƒë·∫•u tranh l√†m s·ª•p ƒë·ªï phong ki·∫øn?",opts:["A. C√°ch m·∫°ng Ph√°p 1789","B. CN c√¥ng nghi·ªáp","C. C√°ch m·∫°ng xanh","D. KHKT"],ans:0},
{id:16,q:"C√°ch m·∫°ng Th√°ng M∆∞·ªùi Nga 1917 l√† gi·ªØa?",opts:["A. N√¥ng d√¢n-ƒë·ªãa ch·ªß","B. T∆∞ s·∫£n-phong ki·∫øn","C. V√¥ s·∫£n-t∆∞ s·∫£n","D. N√¥ng d√¢n-t∆∞ s·∫£n"],ans:2},
{id:17,q:"ƒê·∫•u tranh giai c·∫•p ·ªü VN g·∫Øn li·ªÅn v·ªõi?",opts:["A. D√¢n t·ªôc gi·∫£i ph√≥ng","B. T√¥n gi√°o","C. Kinh t·∫ø","D. Ch√≠nh tr·ªã n·ªôi b·ªô"],ans:0},
{id:18,q:"ƒê·∫•u tranh giai c·∫•p th·ªùi ƒë·ªïi m·ªõi?",opts:["A. X√≥a t∆∞ h·ªØu","B. Ch·ªëng tham nh≈©ng, b·∫•t c√¥ng","C. Qu√¢n s·ª±","D. L·∫≠t ƒë·ªï NN"],ans:1},
{id:19,q:"L·ª±c l∆∞·ª£ng l√£nh ƒë·∫°o ·ªü VN?",opts:["A. NN t∆∞ s·∫£n","B. ƒê·∫£ng CSVN","C. DN t∆∞ nh√¢n","D. C√¥ng ƒëo√†n QT"],ans:1},
{id:20,q:"M·ª•c ti√™u cu·ªëi c√πng ƒë·∫•u tranh giai c·∫•p VN?",opts:["A. Gi√†nh TLSX","B. Th·ªã tr∆∞·ªùng t·ª± do","C. D√¢n gi√†u n∆∞·ªõc m·∫°nh CNXH","D. GDP"],ans:2},
{id:21,q:"Ch√™nh l·ªách gi√†u ngh√®o ·ªü VN ph·∫£n √°nh ƒëi·ªÅu g√¨?",opts:["A. M·ªçi ng∆∞·ªùi ƒë·ªÅu c∆° h·ªôi nh∆∞ nhau","B. XH kh√¥ng c√≤n giai c·∫•p","C. K·∫øt c·∫•u XH‚ÄìGC v·∫´n t·ªìn t·∫°i & bi·∫øn ƒë·ªïi","D. Ai c≈©ng th√†nh ch·ªß TLSX"],ans:2},
{id:22,q:"C√¥ng ngh·ªá, robot, AI thay ƒë·ªïi ƒëi·ªÅu g√¨?",opts:["A. M·∫•t vi·ªác t·∫°m th·ªùi","B. Kh√¥ng ·∫£nh h∆∞·ªüng XH","C. L√†m bi·∫øn ƒë·ªïi l·ª±c l∆∞·ª£ng SX, d·∫´n ƒë·∫øn thay ƒë·ªïi GC","D. Quay l·∫°i nguy√™n th·ªßy"],ans:2},
{id:23,q:"Ng∆∞·ªùi s·ªü h·ªØu c√¥ng ty, ƒë·∫•t ƒëai c√≤n ng∆∞·ªùi kh√°c l√†m thu√™ th·ªÉ hi·ªán:",opts:["A. H·ª£p t√°c b√¨nh ƒë·∫≥ng","B. Quan h·ªá SX c√≥ t√≠nh GC","C. Kh√¥ng b√≥c l·ªôt","D. Chia s·∫ª l·ª£i √≠ch c√¥ng b·∫±ng"],ans:1},
{id:24,q:"T·∫ßng l·ªõp trung l∆∞u tƒÉng l√™n cho th·∫•y:",opts:["A. Kh√¥ng ph√¢n h√≥a","B. K·∫øt c·∫•u XH‚ÄìGC ·ªïn ƒë·ªãnh m√£i","C. K·∫øt c·∫•u XH‚ÄìGC v·∫≠n ƒë·ªông t√≠ch c·ª±c","D. V√¥ s·∫£n chi·∫øm ∆∞u th·∫ø tuy·ªát ƒë·ªëi"],ans:2},
{id:25,q:"H·ªçc t·∫≠p, r√®n luy·ªán gi√∫p con ng∆∞·ªùi:",opts:["A. Gi·ªØ nguy√™n v·ªã tr√≠","B. Vi·ªác nh·∫π h∆°n","C. C√≥ th·ªÉ thay ƒë·ªïi v·ªã tr√≠ GC/TLSX","D. Kh√¥ng ·∫£nh h∆∞·ªüng ƒë·ªãa v·ªã"],ans:2},
{id:26,q:"Nhi·ªÅu ng∆∞·ªùi tr·∫ª mu·ªën kh·ªüi nghi·ªáp th·ªÉ hi·ªán:",opts:["A. √ù th·ª©c v∆∞∆°n l√™n l√†m ch·ªß","B. Ch√°n n·∫£n lao ƒë·ªông","C. T·ª´ b·ªè GC","D. Mu·ªën nh√†n h·∫°"],ans:0},
{id:27,q:"Ch√≠nh s√°ch an sinh x√£ h·ªôi gi√∫p:",opts:["A. Bi·∫øn m·∫•t GC","B. Gi·∫£m m√¢u thu·∫´n, thu h·∫πp kho·∫£ng c√°ch GC","C. T·∫°o GC m·ªõi","D. Kh√¥ng li√™n quan GC"],ans:1},
];

let boardState=Array(9).fill(null);
let currentPlayer=null;
let gameOver=false;
let chosenCell=null;
let answered={};
let waitingForOpponent=false;
let teamToBePlaced=null;
let currentMatch=1;

const board=document.getElementById("board");
const status=document.getElementById("status");
const modal=document.getElementById("modal");
const qText=document.getElementById("qText");
const qOpts=document.getElementById("qOpts");
const feedback=document.getElementById("feedback");
const qGrid=document.getElementById("qGrid");

function buildBoard(){
  board.innerHTML="";
  for(let i=0;i<9;i++){
    const d=document.createElement("div");
    d.className="cell";
    d.dataset.i=i;
    d.onclick=()=>onCellClick(i);
    board.appendChild(d);
  }
}

function buildQuestionGrid(){
  qGrid.innerHTML="";
  for(let i=1;i<=27;i++){
    const btn=document.createElement("button");
    btn.className="qnum";
    if(answered[i])btn.classList.add("answered");
    btn.textContent=i;
    btn.dataset.id=i;
    if(!answered[i])btn.onclick=()=>selectQuestion(i);
    qGrid.appendChild(btn);
  }
}

function onCellClick(i){
  if(gameOver)return;
  if(waitingForOpponent){
    if(boardState[i])return;
    boardState[i]=teamToBePlaced;
    waitingForOpponent=false;
    finishTurnAfterMove();
    return;
  }
  if(boardState[i]||!currentPlayer)return;
  chosenCell=i;
  status.textContent="Ch·ªçn c√¢u h·ªèi.";
}

function selectQuestion(id){
  if(chosenCell===null||answered[id])return;
  openQuestion(id);
}

function openQuestion(id){
  const q=questions.find(x=>x.id===id);
  modal.classList.add("show");
  qText.textContent=q.q;
  qOpts.innerHTML="";
  feedback.textContent="";
  q.opts.forEach((op,idx)=>{
    const b=document.createElement("button");
    b.className="opt";
    b.textContent=op;
    b.onclick=()=>checkAnswer(q,idx);
    qOpts.appendChild(b);
  });
}

function checkAnswer(q,idx){
  Array.from(qOpts.children).forEach((b,i)=>{
    b.disabled=true;
    if(i===q.ans)b.classList.add("correct");
    if(i===idx&&i!==q.ans)b.classList.add("wrong");
  });
  const correct=idx===q.ans;
  feedback.textContent=correct?"‚úÖ ƒê√∫ng r·ªìi!":"‚ùå Sai r·ªìi!";
  answered[q.id]=true;
  setTimeout(()=>{
    modal.classList.remove("show");
    applyMove(correct);
  },900);
}

function applyMove(correct){
  if(chosenCell===null)return;
  if(correct){
    boardState[chosenCell]=currentPlayer;
    finishTurnAfterMove();
  }else{
    waitingForOpponent=true;
    teamToBePlaced=currentPlayer;
    status.textContent="‚ùå Sai r·ªìi! ƒê·ªôi "+(currentPlayer==='X'?'O':'X')+" h√£y ch·ªçn 1 √¥ tr·ªëng ƒë·ªÉ ƒë√°nh h·ªô ƒë·ªôi "+currentPlayer+".";
  }
  updateBoard();
  buildQuestionGrid();
}

function finishTurnAfterMove(){
  updateBoard();
  const win=checkWin();
  if(win){
    status.textContent="üéâ ƒê·ªôi "+win+" th·∫Øng tr·∫≠n "+currentMatch+"!";
    gameOver=true;
    return;
  }
  if(boardState.every(Boolean)){
    status.textContent="H√≤a tr·∫≠n "+currentMatch+"!";
    gameOver=true;
    return;
  }
  currentPlayer=currentPlayer==='X'?'O':'X';
  status.textContent="L∆∞·ª£t c·ªßa ƒë·ªôi "+currentPlayer;
  chosenCell=null;
}

function updateBoard(){
  const cells=document.querySelectorAll(".cell");
  cells.forEach((c,i)=>{
    c.textContent=boardState[i]||"";
    c.classList.toggle("disabled",!!boardState[i]);
    if(boardState[i]==='X')c.style.color="#f87171";
    else if(boardState[i]==='O')c.style.color="#38bdf8";
  });
}

function checkWin(){
  const lines=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(const [a,b,c]of lines){
    if(boardState[a]&&boardState[a]===boardState[b]&&boardState[a]===boardState[c])return boardState[a];
  }
  return null;
}

function resetGame(){
  boardState=Array(9).fill(null);
  currentPlayer=null;
  gameOver=false;
  chosenCell=null;
  answered={};
  waitingForOpponent=false;
  teamToBePlaced=null;
  currentMatch=1;
  buildBoard();
  buildQuestionGrid();
  status.textContent="Ch·ªçn ƒë·ªôi ƒë·ªÉ b·∫Øt ƒë·∫ßu.";
}

function nextMatch(){
  if(currentMatch>=3){alert("ƒê√£ h·∫øt 3 tr·∫≠n!");return;}
  currentMatch++;
  boardState=Array(9).fill(null);
  gameOver=false;
  chosenCell=null;
  waitingForOpponent=false;
  teamToBePlaced=null;
  buildBoard();
  buildQuestionGrid();
  status.textContent="B·∫Øt ƒë·∫ßu tr·∫≠n "+currentMatch+". ƒê·ªôi "+(currentPlayer||"X")+" ch∆°i tr∆∞·ªõc.";
}

document.getElementById("teamX").onclick=()=>{if(gameOver)return;currentPlayer='X';document.getElementById("teamX").classList.add("active");document.getElementById("teamO").classList.remove("active");status.textContent="ƒê·ªôi X b·∫Øt ƒë·∫ßu.";}
document.getElementById("teamO").onclick=()=>{if(gameOver)return;currentPlayer='O';document.getElementById("teamO").classList.add("active");document.getElementById("teamX").classList.remove("active");status.textContent="ƒê·ªôi O b·∫Øt ƒë·∫ßu.";}
document.getElementById("closeModal").onclick=()=>modal.classList.remove("show");
document.getElementById("reset").onclick=resetGame;
document.getElementById("next").onclick=nextMatch;

buildBoard();
buildQuestionGrid();
</script>
</body>
</html>
